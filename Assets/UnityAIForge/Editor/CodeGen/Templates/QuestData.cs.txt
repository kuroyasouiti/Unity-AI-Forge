using System.Collections.Generic;
using UnityEngine;

/// <summary>
/// Quest definition with objectives, prerequisites, and rewards.
/// Generated by Unity-AI-Forge.
/// </summary>
[CreateAssetMenu(menuName = "Game/{{CLASS_NAME}}", fileName = "New{{CLASS_NAME}}")]
public class {{CLASS_NAME}} : ScriptableObject
{
    #region Types

    public enum QuestCategory { Main, Side, Daily, Weekly, Event, Tutorial, Hidden, Custom }
    public enum ObjectiveType { Kill, Collect, Talk, Location, Interact, Escort, Defend, Deliver, Explore, Craft, Custom }
    public enum RewardType { Resource, Item, Experience, Reputation, Unlock, Custom }
    public enum PrerequisiteType { Level, Quest, Resource, Item, Achievement, Reputation, Custom }

    [System.Serializable]
    public class QuestObjective
    {
        public string objectiveId;
        public ObjectiveType type;
        [TextArea(1, 3)] public string description;
        public string targetId;
        public string targetTag;
        public int requiredCount = 1;
        public string locationScene;
        public float locationRadius;
    }

    [System.Serializable]
    public class QuestReward
    {
        public string rewardId;
        public RewardType type;
        public string target;
        public string itemId;
        public float amount;
        public string customData;
    }

    [System.Serializable]
    public class QuestPrerequisite
    {
        public PrerequisiteType type;
        public string target;
        public float value;
        public string comparison;
    }

    #endregion

    [Header("Identity")]
    public string questId = "{{QUEST_ID}}";
    public string title = "{{TITLE}}";
    [TextArea(2, 5)] public string description = "{{DESCRIPTION}}";

    [Header("Category")]
    public QuestCategory category = QuestCategory.{{CATEGORY}};
    public string customCategory;

    [Header("Prerequisites")]
    public List<QuestPrerequisite> prerequisites = new List<QuestPrerequisite>();

    [Header("Objectives")]
    public List<QuestObjective> objectives = new List<QuestObjective>();
    public bool requireAllObjectives = true;

    [Header("Rewards")]
    public List<QuestReward> rewards = new List<QuestReward>();

    [Header("Completion")]
    public bool autoComplete = true;
    public bool repeatable;
    public float cooldownTime;
    public int maxCompletions;

    [Header("UI")]
    public bool trackOnStart = true;
    public bool showNotifications = true;

    #region API

    public QuestObjective GetObjective(string objectiveId)
    {
        return objectives.Find(o => o.objectiveId == objectiveId);
    }

    public void AddObjective(QuestObjective objective)
    {
        if (objective != null) objectives.Add(objective);
    }

    public void RemoveObjective(string objectiveId)
    {
        objectives.RemoveAll(o => o.objectiveId == objectiveId);
    }

    public void AddReward(QuestReward reward)
    {
        if (reward != null) rewards.Add(reward);
    }

    public void RemoveReward(string rewardId)
    {
        rewards.RemoveAll(r => r.rewardId == rewardId);
    }

    #endregion
}
