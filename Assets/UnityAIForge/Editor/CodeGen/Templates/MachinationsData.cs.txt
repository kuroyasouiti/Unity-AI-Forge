using System.Collections.Generic;
using UnityEngine;

/// <summary>
/// Economic system diagram with resource pools, flows, converters, and triggers.
/// Generated by Unity-AI-Forge.
/// </summary>
[CreateAssetMenu(menuName = "Game/{{CLASS_NAME}}", fileName = "New{{CLASS_NAME}}")]
public class {{CLASS_NAME}} : ScriptableObject
{
    #region Types

    public enum ThresholdType { Above, Below, Equal, NotEqual }

    [System.Serializable]
    public class ResourcePool
    {
        public string name;
        public float initialAmount;
        public float minValue;
        public float maxValue = float.MaxValue;
        public Color displayColor = Color.white;
    }

    [System.Serializable]
    public class ResourceFlowDefinition
    {
        public string flowId;
        public string resourceName;
        public float ratePerSecond;
        public bool isSource = true;
        public bool enabledByDefault = true;
        public string description;
    }

    [System.Serializable]
    public class ResourceConverterDefinition
    {
        public string converterId;
        public string fromResource;
        public string toResource;
        public float conversionRate = 1f;
        public float inputCost = 1f;
        public bool enabledByDefault = true;
        public string description;
    }

    [System.Serializable]
    public class ResourceTriggerDefinition
    {
        public string triggerName;
        public string resourceName;
        public ThresholdType thresholdType;
        public float thresholdValue;
        public bool enabled = true;
        public string description;
    }

    #endregion

    [Header("Identity")]
    public string diagramId = "{{DIAGRAM_ID}}";
    [TextArea(1, 3)] public string description;

    [Header("Resources")]
    public List<ResourcePool> pools = new List<ResourcePool>();

    [Header("Flows")]
    public List<ResourceFlowDefinition> flows = new List<ResourceFlowDefinition>();

    [Header("Converters")]
    public List<ResourceConverterDefinition> converters = new List<ResourceConverterDefinition>();

    [Header("Triggers")]
    public List<ResourceTriggerDefinition> triggers = new List<ResourceTriggerDefinition>();

    #region API

    public ResourcePool GetPool(string name)
    {
        return pools.Find(p => p.name == name);
    }

    public ResourceFlowDefinition GetFlow(string flowId)
    {
        return flows.Find(f => f.flowId == flowId);
    }

    public ResourceConverterDefinition GetConverter(string converterId)
    {
        return converters.Find(c => c.converterId == converterId);
    }

    public ResourceTriggerDefinition GetTrigger(string triggerName)
    {
        return triggers.Find(t => t.triggerName == triggerName);
    }

    public List<ResourceFlowDefinition> GetFlowsForResource(string resourceName)
    {
        return flows.FindAll(f => f.resourceName == resourceName);
    }

    #endregion
}
