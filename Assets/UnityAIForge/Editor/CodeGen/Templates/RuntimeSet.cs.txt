using System.Collections.Generic;
using UnityEngine;

/// <summary>
/// ScriptableObject runtime set for tracking active objects.
/// Objects register/unregister themselves via RuntimeSetEntry component.
/// Generated by Unity-AI-Forge.
/// </summary>
[CreateAssetMenu(menuName = "GameKit/Runtime Set", fileName = "{{CLASS_NAME}}")]
public class {{CLASS_NAME}} : ScriptableObject
{
    [Header("Identity")]
    [SerializeField] private string dataId = "{{DATA_ID}}";

    private readonly List<{{ELEMENT_TYPE}}> items = new List<{{ELEMENT_TYPE}}>();

    public string DataId => dataId;
    public IReadOnlyList<{{ELEMENT_TYPE}}> Items => items;
    public int Count => items.Count;

    /// <summary>
    /// Register an item to this set. Called by RuntimeSetEntry.OnEnable().
    /// </summary>
    public void Register({{ELEMENT_TYPE}} item)
    {
        if (item != null && !items.Contains(item))
            items.Add(item);
    }

    /// <summary>
    /// Unregister an item from this set. Called by RuntimeSetEntry.OnDisable().
    /// </summary>
    public void Unregister({{ELEMENT_TYPE}} item)
    {
        items.Remove(item);
    }

    /// <summary>
    /// Get all registered items.
    /// </summary>
    public List<{{ELEMENT_TYPE}}> GetAll()
    {
        return new List<{{ELEMENT_TYPE}}>(items);
    }

    /// <summary>
    /// Check if an item is registered.
    /// </summary>
    public bool Contains({{ELEMENT_TYPE}} item)
    {
        return items.Contains(item);
    }

    /// <summary>
    /// Clear all items. Useful for scene transitions.
    /// </summary>
    public void Clear()
    {
        items.Clear();
    }

    private void OnEnable()
    {
        // Clear stale references when the asset is loaded
        items.Clear();
    }
}
