using UnityEngine;

/// <summary>
/// ScriptableObject data container for shared game state.
/// Supports reset-on-play to restore default values when entering play mode.
/// Generated by Unity-AI-Forge.
/// </summary>
[CreateAssetMenu(menuName = "GameKit/Data Container", fileName = "{{CLASS_NAME}}")]
public class {{CLASS_NAME}} : ScriptableObject
{
    [Header("Identity")]
    [SerializeField] private string dataId = "{{DATA_ID}}";

    [Header("Settings")]
    [SerializeField] private bool resetOnPlay = {{RESET_ON_PLAY}};

    [Header("Data")]
    {{FIELDS}}

    public string DataId => dataId;

    #if UNITY_EDITOR
    private string savedJson;

    private void OnEnable()
    {
        UnityEditor.EditorApplication.playModeStateChanged += OnPlayModeChanged;
    }

    private void OnDisable()
    {
        UnityEditor.EditorApplication.playModeStateChanged -= OnPlayModeChanged;
    }

    private void OnPlayModeChanged(UnityEditor.PlayModeStateChange state)
    {
        if (!resetOnPlay) return;

        if (state == UnityEditor.PlayModeStateChange.ExitingEditMode)
        {
            savedJson = JsonUtility.ToJson(this);
        }
        else if (state == UnityEditor.PlayModeStateChange.EnteredEditMode)
        {
            if (!string.IsNullOrEmpty(savedJson))
            {
                JsonUtility.FromJsonOverwrite(savedJson, this);
                savedJson = null;
            }
        }
    }
    #endif
}
